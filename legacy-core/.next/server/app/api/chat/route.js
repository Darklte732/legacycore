"use strict";(()=>{var e={};e.id=744,e.ids=[744],e.modules={20399:e=>{e.exports=require("next/dist/compiled/next-server/app-page.runtime.prod.js")},30517:e=>{e.exports=require("next/dist/compiled/next-server/app-route.runtime.prod.js")},59227:(e,s,o)=>{o.r(s),o.d(s,{originalPathname:()=>h,patchFetch:()=>y,requestAsyncStorage:()=>u,routeModule:()=>l,serverHooks:()=>g,staticGenerationAsyncStorage:()=>d});var t={};o.r(t),o.d(t,{GET:()=>p,POST:()=>c});var r=o(49303),n=o(88716),a=o(60670),i=o(87070);async function c(e){try{let s=await e.json();console.log("Chat proxy received:",s),s.sessionId?console.log("Session ID:",s.sessionId):(console.log("No session ID provided"),s.sessionId=`fallback_${Date.now()}`),s.agentId&&console.log("Agent ID:",s.agentId);try{let e;let o=await fetch("https://n8n-mybh5-u38603.vm.elestio.app/webhook/AICHAT",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(s)});if(console.log("N8n status:",o.status),!o.ok){let e=await o.text().catch(()=>"Unknown error");return console.error(`N8n webhook error (${o.status}):`,e),i.NextResponse.json({response:`I'm sorry, I'm having trouble processing your request right now. Please try again later. (Error: ${o.status})`,error:!0,sessionId:s.sessionId},{status:200})}let t=await o.text();if(console.log("Raw n8n response:",t),t&&t.trim())try{let s=JSON.parse(t);console.log("Parsed as JSON:",s),e="object"==typeof s&&null!==s?s.response?s:s.text||s.message||s.content?{response:s.text||s.message||s.content}:{response:`Response: ${JSON.stringify(s)}`}:"string"==typeof s?{response:s}:{response:`Received: ${JSON.stringify(s)}`}}catch(s){console.log("Failed to parse as JSON, using raw text"),e={response:t}}else e={response:"I've received your message and am processing it."};return s.sessionId&&"object"==typeof e&&(e.sessionId=s.sessionId),console.log("Sending response to client:",e),i.NextResponse.json(e)}catch(e){return console.error("Error connecting to n8n webhook:",e),i.NextResponse.json({response:"I'm sorry, I couldn't connect to my knowledge service. Please check your network connection and try again.",error:!0,sessionId:s.sessionId},{status:200})}}catch(e){return console.error("Error in chat proxy:",e),i.NextResponse.json({error:"Failed to process request",response:"Sorry, I encountered an error processing your request."},{status:200})}}async function p(){return i.NextResponse.json({status:"Chat API ready"})}let l=new r.AppRouteRouteModule({definition:{kind:n.x.APP_ROUTE,page:"/api/chat/route",pathname:"/api/chat",filename:"route",bundlePath:"app/api/chat/route"},resolvedPagePath:"C:\\Users\\Ronel\\Downloads\\New folder (5)\\legacycore\\legacy-core\\src\\app\\api\\chat\\route.ts",nextConfigOutput:"standalone",userland:t}),{requestAsyncStorage:u,staticGenerationAsyncStorage:d,serverHooks:g}=l,h="/api/chat/route";function y(){return(0,a.patchFetch)({serverHooks:g,staticGenerationAsyncStorage:d})}}};var s=require("../../../webpack-runtime.js");s.C(e);var o=e=>s(s.s=e),t=s.X(0,[8948,5972],()=>o(59227));module.exports=t})();