(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[3592],{8346:function(e,t,s){Promise.resolve().then(s.bind(s,32080))},47390:function(e,t,s){"use strict";s.d(t,{Z:function(){return r}});/**
 * @license lucide-react v0.321.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */let r=(0,s(81066).Z)("MessageSquare",[["path",{d:"M21 15a2 2 0 0 1-2 2H7l-4 4V5a2 2 0 0 1 2-2h14a2 2 0 0 1 2 2z",key:"1lielz"}]])},32080:function(e,t,s){"use strict";s.r(t),s.d(t,{default:function(){return $}});var r=s(57437),a=s(2265),n=s(28590);s(12151);var o=s(66648),i=s(64902),l=s(55715),c=s(54817),d=s(22468),m=s(74697),g=s(10883);let u=e=>{let{chats:t=[],activeChat:s=null,onSelectChat:n=()=>{},onCreateNewChat:u=()=>{},onDeleteChat:h=()=>{},loading:x=!1}=e,{user:p}=(0,i.E)(),[f,y]=(0,a.useState)(""),[b,w]=(0,a.useState)(null),[v,j]=(0,a.useState)(null),N=f?t.filter(e=>e.title.toLowerCase().includes(f.toLowerCase())):t,k=e=>{let t=new Date(e),s=new Date;if(t.toDateString()===s.toDateString())return"Today";let r=new Date(s);if(r.setDate(s.getDate()-1),t.toDateString()===r.toDateString())return"Yesterday";let a=new Date(s);return(a.setDate(s.getDate()-7),t>a)?t.toLocaleDateString(void 0,{weekday:"long"}):t.toLocaleDateString(void 0,{month:"short",day:"numeric"})};return(0,r.jsxs)("aside",{className:"flex h-screen flex-col bg-gradient-to-b from-gray-900 via-gray-850 to-gray-800 text-white w-full shadow-xl",children:[(0,r.jsxs)("div",{className:"p-4 border-b border-indigo-900/40 bg-gradient-to-br from-gray-900 to-indigo-900/40",children:[(0,r.jsxs)("div",{className:"flex items-center mb-5",children:[(0,r.jsx)("div",{className:"w-11 h-11 mr-3 relative flex-shrink-0",children:(0,r.jsx)(o.default,{src:"/logo.png",alt:"LegacyCore Logo",width:44,height:44,className:"object-contain"})}),(0,r.jsxs)("div",{children:[(0,r.jsx)("h2",{className:"font-bold text-xl text-white",children:"Manager AI"}),(0,r.jsx)("p",{className:"text-xs text-indigo-200/70 font-light",children:"Powered by LegacyCore"})]})]}),(0,r.jsxs)("button",{onClick:u,className:"w-full flex items-center justify-center py-3 px-4 rounded-lg bg-gradient-to-r from-indigo-600 to-purple-600 hover:from-indigo-700 hover:to-purple-700 shadow-md transition-all duration-200 ease-in-out transform hover:scale-[1.02] hover:shadow-lg border border-indigo-500/30",children:[(0,r.jsx)(l.Z,{size:18,className:"mr-2"}),(0,r.jsx)("span",{className:"font-medium",children:"New Chat"})]})]}),p&&(0,r.jsx)("div",{className:"border-b border-indigo-900/20 p-4 bg-gray-800/40",children:(0,r.jsxs)("div",{className:"flex items-center",children:[p.avatar_url?(0,r.jsx)(o.default,{src:p.avatar_url,alt:p.user_metadata?.name||"User",width:38,height:38,className:"rounded-full mr-3 ring-2 ring-indigo-500/30 border border-white/10"}):(0,r.jsx)("div",{className:"w-9 h-9 rounded-full bg-gradient-to-br from-indigo-500 to-purple-600 flex items-center justify-center mr-3 shadow-md border border-white/10",children:(0,r.jsx)("span",{className:"text-sm font-semibold text-white",children:(p.user_metadata?.name||p.email||"U").charAt(0).toUpperCase()})}),(0,r.jsxs)("div",{className:"text-sm truncate",children:[(0,r.jsx)("p",{className:"font-semibold text-white",children:p.user_metadata?.name||"Manager"}),(0,r.jsx)("p",{className:"text-gray-300 text-xs truncate",children:p.email})]})]})}),(0,r.jsx)("div",{className:"p-4 border-b border-indigo-900/20 bg-gray-800/20",children:(0,r.jsxs)("div",{className:"relative",children:[(0,r.jsx)("div",{className:"absolute inset-y-0 left-0 pl-3 flex items-center pointer-events-none",children:(0,r.jsx)(c.Z,{size:16,className:"text-indigo-300/70"})}),(0,r.jsx)("input",{type:"text",placeholder:"Search chats...",className:"block w-full pl-10 pr-3 py-2.5 rounded-lg bg-gray-700/60 border border-indigo-500/20 focus:ring-2 focus:ring-indigo-500/70 focus:border-indigo-500 focus:outline-none text-sm transition-all duration-200 text-white shadow-inner",value:f,onChange:e=>y(e.target.value)})]})}),(0,r.jsx)("div",{className:"flex-1 overflow-y-auto scrollbar-thin scrollbar-thumb-indigo-600/40 scrollbar-track-gray-800/40",children:x?(0,r.jsxs)("div",{className:"p-4 space-y-4",children:[(0,r.jsxs)("div",{className:"animate-pulse",children:[(0,r.jsx)("div",{className:"h-4 bg-gray-700/70 rounded mb-3"}),(0,r.jsx)("div",{className:"h-4 bg-gray-700/70 rounded w-5/6 mb-3"}),(0,r.jsx)("div",{className:"h-4 bg-gray-700/70 rounded w-4/6"})]}),(0,r.jsxs)("div",{className:"animate-pulse",children:[(0,r.jsx)("div",{className:"h-4 bg-gray-700/70 rounded mb-3"}),(0,r.jsx)("div",{className:"h-4 bg-gray-700/70 rounded w-5/6 mb-3"}),(0,r.jsx)("div",{className:"h-4 bg-gray-700/70 rounded w-4/6"})]})]}):0===N.length?(0,r.jsxs)("div",{className:"p-6 text-center text-gray-400",children:[(0,r.jsx)("div",{className:"inline-flex items-center justify-center w-16 h-16 rounded-full bg-gray-800/80 mb-4",children:(0,r.jsx)(c.Z,{size:24,className:"text-indigo-400"})}),(0,r.jsx)("p",{className:"text-sm font-medium text-gray-300",children:f?"No chats match your search":"No chats yet"}),(0,r.jsx)("p",{className:"text-xs text-indigo-300/50 mt-1",children:f?"Try another search term":"Start a new conversation"})]}):(0,r.jsx)("div",{className:"divide-y divide-indigo-900/10",children:N.map(e=>(0,r.jsx)("div",{className:`relative ${s===e.id?"bg-indigo-600/20 border-l-4 border-l-indigo-500":"hover:bg-gray-700/40 border-l-4 border-l-transparent"} transition-all duration-200 cursor-pointer`,onMouseEnter:()=>w(e.id),onMouseLeave:()=>{w(null),v||j(null)},children:(0,r.jsxs)("div",{className:"px-4 py-3.5",onClick:()=>n(e.id),children:[(0,r.jsxs)("div",{className:"flex justify-between items-start",children:[(0,r.jsx)("h3",{className:"font-medium text-sm truncate text-white",style:{maxWidth:"80%"},children:e.title||"New Chat"}),(0,r.jsx)("span",{className:"text-xs text-indigo-300/70",children:k(e.createdAt)})]}),(0,r.jsx)("p",{className:"text-xs text-gray-400 truncate mt-1",children:e.messages.length>0?e.messages[e.messages.length-1].content.substring(0,50)+(e.messages[e.messages.length-1].content.length>50?"...":""):"No messages yet"}),(b===e.id||v===e.id)&&(0,r.jsx)("div",{className:"absolute top-2 right-2",children:v===e.id?(0,r.jsxs)("div",{className:"flex items-center bg-gray-900/90 rounded-lg overflow-hidden shadow-lg border border-gray-700/50",children:[(0,r.jsxs)("button",{onClick:t=>{t.stopPropagation(),h(e.id),j(null)},className:"px-2 py-1.5 text-xs bg-red-600 hover:bg-red-700 text-white flex items-center",title:"Confirm Delete",children:[(0,r.jsx)(d.Z,{size:14,className:"mr-1"}),"Delete"]}),(0,r.jsxs)("button",{onClick:e=>{e.stopPropagation(),j(null)},className:"px-2 py-1.5 text-xs bg-gray-700 hover:bg-gray-800 text-white flex items-center",title:"Cancel",children:[(0,r.jsx)(m.Z,{size:14,className:"mr-1"}),"Cancel"]})]}):(0,r.jsx)("button",{onClick:t=>{t.stopPropagation(),j(e.id)},className:"p-1.5 rounded-full bg-gray-800/80 hover:bg-red-600/80 text-gray-400 hover:text-white transition-all duration-200",title:"Delete Chat",children:(0,r.jsx)(g.Z,{size:14})})})]})},e.id))})}),(0,r.jsx)("div",{className:"p-3 text-center border-t border-indigo-900/30 text-xs text-gray-500 bg-gradient-to-t from-gray-900 to-gray-800/70",children:(0,r.jsx)("p",{children:"LegacyCore Manager AI v1.0"})})]})},h=[{quote:"The best time to plant a tree was 20 years ago. The second best time is now.",author:"Chinese Proverb",message:"Every client interaction is an opportunity to build your business for the future."},{quote:"Success is not final, failure is not fatal: It is the courage to continue that counts.",author:"Winston Churchill",message:"Insurance is about resilience. Your clients look to you for guidance through uncertainty."},{quote:"Your work is going to fill a large part of your life, and the only way to be truly satisfied is to do what you believe is great work.",author:"Steve Jobs",message:"When you protect families and businesses, you're doing truly meaningful work."},{quote:"The future belongs to those who believe in the beauty of their dreams.",author:"Eleanor Roosevelt",message:"Help your clients protect their dreams and secure their future."},{quote:"Don't watch the clock; do what it does. Keep going.",author:"Sam Levenson",message:"Consistency in client outreach leads to long-term success in insurance."},{quote:"The only limit to our realization of tomorrow will be our doubts of today.",author:"Franklin D. Roosevelt",message:"Each conversation is a step toward securing someone's future."},{quote:"Believe you can and you're halfway there.",author:"Theodore Roosevelt",message:"Your confidence in your products gives clients peace of mind."},{quote:"The best preparation for tomorrow is doing your best today.",author:"H. Jackson Brown, Jr.",message:"The right planning today prevents emergencies tomorrow."},{quote:"Your attitude, not your aptitude, will determine your altitude.",author:"Zig Ziglar",message:"A positive approach to client service will elevate your insurance practice."},{quote:"The key is not to prioritize what's on your schedule, but to schedule your priorities.",author:"Stephen Covey",message:"Make time for your most valuable clients and prospects each day."},{quote:"People don't care how much you know until they know how much you care.",author:"Theodore Roosevelt",message:"In insurance, relationships matter more than policies."},{quote:"The expert in anything was once a beginner.",author:"Helen Hayes",message:"Every insurance professional started with their first client conversation."},{quote:"Success is walking from failure to failure with no loss of enthusiasm.",author:"Winston Churchill",message:"Every 'no' brings you closer to your next 'yes'."},{quote:"It's not about having time, it's about making time.",author:"Unknown",message:"Schedule your follow-ups and client check-ins like they're your most important meetings."},{quote:"The pessimist sees difficulty in every opportunity. The optimist sees opportunity in every difficulty.",author:"Winston Churchill",message:"Every client problem is a chance to demonstrate your value as an insurance professional."}],x=()=>{let e=new Date,t=Math.floor((e-new Date(e.getFullYear(),0,0))/864e5)%h.length;return h[t]};var p=()=>{let[e,t]=(0,a.useState)(x()),[s,n]=(0,a.useState)(new Date);(0,a.useEffect)(()=>{let e=setInterval(()=>{n(new Date)},6e4);return()=>clearInterval(e)},[]);let o=s.toLocaleTimeString([],{hour:"2-digit",minute:"2-digit",hour12:!0}),i=s.toLocaleDateString([],{month:"long",day:"numeric",year:"numeric"});return(0,r.jsxs)("div",{className:"welcome-container p-6 flex flex-col items-center justify-center text-center",children:[(0,r.jsxs)("div",{className:"time-display mb-3",children:[(0,r.jsx)("h2",{className:"text-3xl font-bold text-indigo-600 dark:text-indigo-400",children:o}),(0,r.jsx)("p",{className:"text-gray-600 dark:text-gray-400",children:i})]}),(0,r.jsx)("div",{className:"inspiration-card max-w-2xl w-full bg-white dark:bg-gray-800 rounded-xl shadow-md overflow-hidden transition-all duration-500 hover:shadow-lg mt-6",children:(0,r.jsxs)("div",{className:"p-8",children:[(0,r.jsx)("div",{className:"quote-icon flex justify-center mb-4",children:(0,r.jsx)("div",{className:"w-12 h-12 rounded-full bg-indigo-100 dark:bg-indigo-900/30 flex items-center justify-center",children:(0,r.jsx)("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-6 w-6 text-indigo-600 dark:text-indigo-400",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:(0,r.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M7 8h10M7 12h4m1 8l-4-4H5a2 2 0 01-2-2V6a2 2 0 012-2h14a2 2 0 012 2v8a2 2 0 01-2 2h-3l-4 4z"})})})}),(0,r.jsxs)("blockquote",{className:"text-xl italic font-medium text-gray-800 dark:text-gray-200 mb-4",children:['"',e.quote,'"']}),(0,r.jsxs)("p",{className:"text-right text-gray-600 dark:text-gray-400 font-medium mb-6",children:["— ",e.author]}),(0,r.jsx)("div",{className:"mt-4 pt-4 border-t border-gray-200 dark:border-gray-700",children:(0,r.jsx)("p",{className:"text-gray-700 dark:text-gray-300",children:e.message})})]})}),(0,r.jsxs)("div",{className:"mt-6 flex flex-col items-center",children:[(0,r.jsx)("p",{className:"text-gray-600 dark:text-gray-400 mb-2",children:"Start a new conversation or select a previous chat"}),(0,r.jsx)("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-5 w-5 text-indigo-500 animate-bounce",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:(0,r.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M19 14l-7 7m0 0l-7-7m7 7V3"})})]})]})},f=s(50793);let y=e=>{let{id:t,role:s,content:n,timestamp:i,onDelete:l}=e,[c,d]=(0,a.useState)(!1),[m,g]=(0,a.useState)(!1);return(0,r.jsxs)("div",{className:`flex ${"assistant"===s?"bg-gray-50":"bg-white"} rounded-lg p-4 relative group`,onMouseLeave:()=>{d(!1),setTimeout(()=>{g(!1)},200)},children:[(0,r.jsx)("div",{className:"mr-4 flex-shrink-0",children:"assistant"===s?(0,r.jsx)(o.default,{src:"/images/agent-icon.png",alt:"Assistant",width:36,height:36,className:"rounded-full"}):(0,r.jsx)("div",{className:"w-9 h-9 rounded-full bg-indigo-500 flex items-center justify-center",children:(0,r.jsx)("span",{className:"text-white text-sm font-medium",children:"U"})})}),(0,r.jsxs)("div",{className:"flex-1 min-w-0",children:[(0,r.jsxs)("div",{className:"flex items-center mb-1",children:[(0,r.jsx)("p",{className:"font-medium text-gray-900 mr-2",children:"assistant"===s?"LegacyCore AI":"You"}),(0,r.jsx)("p",{className:"text-xs text-gray-500",children:(e=>{try{return new Date(e).toLocaleTimeString([],{hour:"2-digit",minute:"2-digit"})}catch(e){return""}})(i)})]}),(0,r.jsx)("div",{className:"message-content prose prose-sm max-w-none text-gray-600",dangerouslySetInnerHTML:{__html:n}})]}),t&&l&&(0,r.jsxs)("div",{className:`absolute top-2 right-2 ${c?"block":"hidden group-hover:block"}`,children:[(0,r.jsx)("button",{className:"p-1 rounded hover:bg-gray-200 text-gray-500 hover:text-gray-700",onClick:()=>d(!c),children:(0,r.jsxs)("svg",{xmlns:"http://www.w3.org/2000/svg",width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[(0,r.jsx)("circle",{cx:"12",cy:"12",r:"1"}),(0,r.jsx)("circle",{cx:"19",cy:"12",r:"1"}),(0,r.jsx)("circle",{cx:"5",cy:"12",r:"1"})]})}),c&&(0,r.jsx)("div",{className:"absolute top-full right-0 mt-1 w-32 bg-white border border-gray-200 rounded shadow-lg z-10",children:(0,r.jsxs)("button",{className:"flex items-center w-full px-3 py-2 text-sm text-left hover:bg-gray-100 text-red-600",onClick:()=>{m&&t&&l?(l(t),d(!1),g(!1)):g(!0)},children:[(0,r.jsxs)("svg",{xmlns:"http://www.w3.org/2000/svg",width:"14",height:"14",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",className:"mr-2",children:[(0,r.jsx)("path",{d:"M3 6h18"}),(0,r.jsx)("path",{d:"M19 6v14c0 1-1 2-2 2H7c-1 0-2-1-2-2V6"}),(0,r.jsx)("path",{d:"M8 6V4c0-1 1-2 2-2h4c1 0 2 1 2 2v2"})]}),m?"Confirm":"Delete"]})})]})]})},b=e=>e.includes("Error:")||e.includes("I apologize")||e.includes("sorry")?"error":[/\$\d+(\.\d+)?/g,/\d+%/g,/total:/i,/summary:/i,/statistics:/i,/\|\s*[\w\s]+\s*\|/g,/\b(database|query|result)\b/i].some(t=>t.test(e))?"data":(e.match(/\d+\.\s+/g)||[]).length+(e.match(/^\s*[\*\-\•]\s+/gm)||[]).length>3?"list":"conversation",w=e=>e.replace(/\n{2,}/g,"<br><br>").replace(/\n/g," ").replace(/(\d+\.\s+)([^\n]+)/g,'<span class="text-teal-300">$1</span>$2<br>').replace(/^[\*\-\•]\s+([^\n]+)/gm,"• $1<br>").replace(/"([^"]+)"/g,'<span class="text-indigo-300">"$1"</span>').replace(/!(Important|Note|Warning|Tip):/gi,'<strong class="text-yellow-300">$1:</strong>').replace(/`([^`]+)`/g,'<code class="bg-gray-700 rounded px-1 py-0.5 text-sm">$1</code>'),v=e=>e.replace(/\n{2,}/g,"<br><br>").replace(/(\$\d+(\.\d+)?)/g,'<span class="text-green-400 font-medium">$1</span>').replace(/(\d+%)/g,'<span class="text-indigo-300 font-medium">$1</span>').replace(/\n?(#+)\s+([^\n]+)/g,(e,t,s)=>{let r=t.length;return`<div class="font-bold text-${1===r?"xl":2===r?"lg":"md"} my-3 text-teal-300">${s}</div>`}).replace(/(Total:|Summary:|Results:|Statistics:)(\s*[\w\s\$\d\.\,]+)/gi,'<div class="my-2"><span class="text-teal-300 font-medium">$1</span>$2</div>').replace(/`([^`]+)`/g,'<code class="bg-gray-700 rounded px-1 py-0.5 text-sm">$1</code>').replace(/(https?:\/\/[^\s]+)/g,'<a href="$1" target="_blank" class="text-blue-400 underline">$1</a>'),j=e=>{let t=e.replace(/"list-item">/g,"");if(t.split(/(\d+\.\s+|\*\s+|\-\s+|\•\s+)/).length<=1)return w(t);let s=t.search(/(\d+\.\s+|\*\s+|\-\s+|\•\s+)/),r=s>0?t.substring(0,s):"",a=t.substring(s);return(r?w(r)+"<br><br>":"")+a.replace(/(\d+\.\s+)([^\n]+)/g,'<div class="list-item"><span class="text-teal-300 font-medium">$1</span>$2</div>').replace(/^[\*\-\•]\s+([^\n]+)/gm,'<div class="list-item">$1</div>').replace(/\n/g,"<br>").replace(/"([^"]+)"/g,'<span class="text-indigo-300">"$1"</span>').replace(/!(Important|Note|Warning|Tip):/gi,'<strong class="text-yellow-300">$1:</strong>')},N=e=>`<div class="text-red-400">${e}</div>`,k=e=>{if(!e)return"";let t=e.trim();switch(b(t=(t=t.replace(/"list-item">([^<\n]*)/g,"<li>$1</li>")).replace(/"list-item">\s*-\s*([^<\n]*)/g,"<li>$1</li>"))){case"data":return v(t);case"list":return j(t);case"error":return N(t);default:return w(t)}};var C=s(47390);let S=`
  .message-content p {
    margin-bottom: 0.75rem;
  }
  
  .message-content ul, .message-content ol {
    margin-left: 1.5rem;
    margin-bottom: 0.75rem;
  }
  
  .message-content li {
    margin-bottom: 0.25rem;
  }
  
  .message-content h1, .message-content h2, .message-content h3 {
    font-weight: bold;
    margin-top: 1rem;
    margin-bottom: 0.5rem;
  }
  
  .message-content blockquote {
    border-left: 4px solid #e5e7eb;
    padding-left: 1rem;
    font-style: italic;
    margin: 0.75rem 0;
  }
  
  .message-content pre {
    background-color: #f3f4f6;
    padding: 0.75rem;
    border-radius: 0.25rem;
    overflow-x: auto;
    margin: 0.75rem 0;
  }
  
  .message-content code {
    background-color: #f3f4f6;
    padding: 0.25rem;
    border-radius: 0.25rem;
    font-family: monospace;
  }
  
  .message-content table {
    border-collapse: collapse;
    width: 100%;
    margin: 0.75rem 0;
  }
  
  .message-content th, .message-content td {
    border: 1px solid #e5e7eb;
    padding: 0.5rem;
    text-align: left;
  }
  
  .message-content th {
    background-color: #f9fafb;
  }
  
  .key-point {
    font-weight: 600;
    color: #1e40af;
  }
  
  .list-item {
    display: block;
    padding-left: 1.5rem;
    position: relative;
    margin-bottom: 0.5rem;
  }
  
  .list-item:before {
    content: "•";
    position: absolute;
    left: 0.5rem;
  }
`;var $=()=>{let{user:e,loading:t}=(0,i.E)(),[s,o]=(0,a.useState)(""),[l,c]=(0,a.useState)([]),[d,m]=(0,a.useState)(!1),[g,h]=(0,a.useState)([]),[x,b]=(0,a.useState)(null),[w,v]=(0,a.useState)(!0),[j,N]=(0,a.useState)(!1),$=(0,a.useRef)(null),A=(0,a.useRef)(null),D=(0,a.useRef)(null),L=(0,a.useRef)(null),T=(0,a.useRef)(null),[E,I]=(0,a.useState)(""),[M,q]=(0,a.useState)({messageCount:0,lastAction:"Initial load"}),W=e=>({id:e.id,title:e.title,messages:e.messages.map(e=>({role:e.role,content:e.content,timestamp:e.timestamp})),createdAt:e.createdAt}),z=e=>({role:e.role,content:e.content,timestamp:e.timestamp}),_=()=>{L.current&&T.current&&(L.current.classList.toggle("translate-x-0"),T.current.classList.toggle("opacity-0"),T.current.classList.toggle("pointer-events-none"))};(0,a.useEffect)(()=>{t||(async()=>{if(!e){h([]),v(!1);return}v(!0);try{let e=await f.A.getChats(),t=e.map(W);h(t),e.length>0&&!x&&(b(e[0].id),c(t[0].messages))}catch(e){console.error("Error loading chats:",e)}finally{v(!1)}})()},[e,t]),(0,a.useEffect)(()=>{I((0,n.Z)()),$.current&&($.current.scrollTop=$.current.scrollHeight)},[]),(0,a.useEffect)(()=>{if($.current){let e=setTimeout(()=>{let e=$.current;e&&e.scrollTo({top:e.scrollHeight,behavior:"smooth"})},100);return()=>clearTimeout(e)}},[l,d]),(0,a.useEffect)(()=>{let e=e=>{"/"===e.key&&document.activeElement!==D.current&&(e.preventDefault(),D.current?.focus())};return window.addEventListener("keydown",e),()=>window.removeEventListener("keydown",e)},[]);let H=async(t,s)=>{console.log("Attempting to connect to webhook with:",{message:t,sessionId:s});try{let r=await fetch("https://n8n-mybh5-u38603.vm.elestio.app/webhook/AICHAT",{method:"POST",headers:{"Content-Type":"application/json",Accept:"application/json"},body:JSON.stringify({message:t,sessionId:s,managerId:e?.id||"",timestamp:new Date().toISOString()})});if(console.log("Webhook response status:",r.status),r.status>=200&&r.status<300){let e=await r.json().catch(()=>({}));return console.log("Webhook raw response data:",e),{success:!0,data:e}}{let e=await r.text().catch(()=>"Unknown error");return console.error(`Webhook error: ${r.status}`,e),{success:!1,error:`Webhook error: ${r.status}`,details:e}}}catch(e){return console.error("Webhook connection error:",e),{success:!1,error:"Failed to connect to webhook",details:e.message||"Unknown error occurred"}}},Z=async()=>{if(e)try{let e=await f.A.createChat();if(!e){console.error("Failed to create new chat");return}let t=W(e);h([t,...g]),b(t.id),c([]),q({messageCount:0,lastAction:"Created new chat"})}catch(e){console.error("Error creating new chat:",e)}},R=async e=>{b(e);let t=g.find(t=>t.id===e);if(t)c(t.messages);else{let t=await f.A.getChat(e);t&&c(W(t).messages)}q({messageCount:t?.messages.length||0,lastAction:"Selected chat"})},B=async e=>{let t=g.filter(t=>t.id!==e);h(t),x===e&&(t.length>0?(b(t[0].id),c(t[0].messages)):(b(null),c([])));try{if(console.log(`Attempting to delete chat ${e} and its messages...`),await f.A.deleteChat(e))console.log(`Successfully deleted chat ${e}`);else{console.error("Failed to delete chat from Supabase");let t=await f.A.getChats(),s=t.map(W);if(h(s),x===e&&t.some(t=>t.id===e)){b(e);let t=s.find(t=>t.id===e);t&&c(t.messages)}}}catch(e){console.error("Error deleting chat:",e)}},O=async e=>{if(e&&e.preventDefault(),!s.trim())return;if(!x){let e=await f.A.createChat(s);if(e){let t=W(e);b(t.id),h([t,...g])}else{console.error("Failed to create new chat");return}}m(!0);let t={role:"user",content:s,timestamp:new Date().toISOString()},r=[...l,t];c(r),await f.A.addMessage(x,z(t)),o(""),q({messageCount:r.length,lastAction:"Added user message"});try{let e=await H(s,E);if(e){let t;if(e.success&&e.data){if("string"==typeof e.data)t=e.data;else if(e.data.response)t=e.data.response;else if(e.data.output)t=e.data.output;else if(e.data.text)t=e.data.text;else if(e.data.message)t=e.data.message;else try{t=JSON.stringify(e.data)}catch(e){t="Received data in an unexpected format."}}else t=e.error?`Error: ${e.error}. ${e.details||""}`:"No readable response received from the assistant.";let a=k(t),n={role:"assistant",content:a,timestamp:new Date().toISOString()},o=[...r,n];if(c(o),await f.A.addMessage(x,z(n)),q({messageCount:o.length,lastAction:"Added assistant response"}),1===r.length){let e=s.length>30?`${s.substring(0,30)}...`:s;await f.A.updateChatTitle(x,e);let t=g.map(t=>t.id===x?{...t,title:e,messages:o}:t);h(t)}else{let e=g.map(e=>e.id===x?{...e,messages:o}:e);h(e)}}}catch(t){console.error("Error sending message to webhook:",t);let e={role:"assistant",content:"I apologize, but I encountered an error while processing your request. Please try again later.",timestamp:new Date().toISOString()};c([...r,e]),await f.A.addMessage(x,z(e))}finally{m(!1)}},P=async e=>{if(x)try{if(console.log(`Attempting to delete message ${e}...`),await f.A.deleteMessage(e)){console.log(`Successfully deleted message ${e}`);let t=l.filter(t=>t.id!==e);c(t);let s=g.map(t=>t.id===x?{...t,messages:t.messages.filter(t=>t.id!==e)}:t);h(s),q({messageCount:t.length,lastAction:"Deleted message"})}else console.error(`Failed to delete message ${e}`)}catch(e){console.error("Error deleting message:",e)}};return(0,r.jsxs)("div",{className:"flex min-h-screen bg-white",children:[(0,r.jsx)("style",{dangerouslySetInnerHTML:{__html:S}}),(0,r.jsx)("div",{ref:T,className:"fixed inset-0 z-20 bg-black/50 opacity-0 pointer-events-none transition-opacity md:hidden",onClick:_}),(0,r.jsx)("div",{ref:L,className:"fixed top-0 left-0 z-30 h-full w-72 -translate-x-full transform transition-transform md:translate-x-0 md:static md:z-0",children:(0,r.jsx)(u,{chats:g,activeChat:x,onSelectChat:R,onCreateNewChat:Z,onDeleteChat:B,loading:w})}),(0,r.jsxs)("div",{className:"flex flex-1 flex-col",children:[(0,r.jsxs)("header",{className:"border-b border-gray-200 bg-white py-3 px-4 flex items-center justify-between",children:[(0,r.jsxs)("div",{className:"flex items-center",children:[(0,r.jsx)("button",{className:"mr-3 rounded p-1 text-gray-500 hover:bg-gray-100 md:hidden",onClick:_,children:(0,r.jsxs)("svg",{xmlns:"http://www.w3.org/2000/svg",width:"24",height:"24",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",className:"lucide lucide-menu",children:[(0,r.jsx)("line",{x1:"4",x2:"20",y1:"12",y2:"12"}),(0,r.jsx)("line",{x1:"4",x2:"20",y1:"6",y2:"6"}),(0,r.jsx)("line",{x1:"4",x2:"20",y1:"18",y2:"18"})]})}),(0,r.jsx)("h1",{className:"text-lg font-semibold",children:(()=>{if(!x)return"New Chat";let e=g.find(e=>e.id===x);return e?e.title:"Chat"})()})]}),(0,r.jsx)("button",{onClick:Z,className:"rounded p-1 text-gray-500 hover:bg-gray-100",title:"New Chat",children:(0,r.jsxs)("svg",{xmlns:"http://www.w3.org/2000/svg",width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",className:"lucide lucide-plus",children:[(0,r.jsx)("path",{d:"M5 12h14"}),(0,r.jsx)("path",{d:"M12 5v14"})]})})]}),(0,r.jsx)("div",{ref:$,className:"flex-1 overflow-y-auto p-4 chat-messages",children:0===l.length?(0,r.jsxs)("div",{className:"flex flex-col items-center justify-center h-full py-8 px-4",children:[(0,r.jsx)("div",{className:"w-16 h-16 rounded-full bg-gradient-to-br from-indigo-500 to-purple-600 flex items-center justify-center mb-4 shadow-lg",children:(0,r.jsx)(C.Z,{size:32,className:"text-white"})}),(0,r.jsx)("h2",{className:"text-3xl font-bold mb-3 text-center bg-clip-text text-transparent bg-gradient-to-r from-indigo-500 to-purple-600",children:"LegacyCore Manager AI"}),(0,r.jsx)("p",{className:"text-center text-gray-600 mb-8 max-w-md",children:"Welcome to your AI-powered insurance assistant. Ask me anything about your agents, carriers, policies, or insurance questions."}),(0,r.jsx)(p,{}),(0,r.jsx)("div",{className:"mt-8 w-full max-w-md",children:(0,r.jsxs)("div",{className:"border border-gray-300 rounded-lg p-2 bg-gray-50",children:[(0,r.jsx)("p",{className:"text-sm font-medium text-gray-700 mb-2",children:"Try asking:"}),(0,r.jsxs)("div",{className:"space-y-2",children:[(0,r.jsx)("button",{onClick:()=>o("How can I improve my team's performance?"),className:"block w-full rounded-md bg-white px-3 py-2 text-left text-sm text-gray-700 shadow-sm hover:bg-gray-100 transition-colors",children:"How can I improve my team's performance?"}),(0,r.jsx)("button",{onClick:()=>o("What are some best practices for hiring new agents?"),className:"block w-full rounded-md bg-white px-3 py-2 text-left text-sm text-gray-700 shadow-sm hover:bg-gray-100 transition-colors",children:"What are some best practices for hiring new agents?"}),(0,r.jsx)("button",{onClick:()=>o("Summarize the latest carriers' payout rates"),className:"block w-full rounded-md bg-white px-3 py-2 text-left text-sm text-gray-700 shadow-sm hover:bg-gray-100 transition-colors",children:"Summarize the latest carriers' payout rates"})]})]})})]}):(0,r.jsxs)("div",{className:"max-w-3xl mx-auto space-y-4",children:[l.map(e=>(0,r.jsx)(y,{id:e.id,role:e.role,content:e.content,timestamp:e.timestamp,onDelete:e.id?P:void 0},e.id)),d&&(0,r.jsxs)("div",{className:"flex items-center space-x-2 p-2 rounded-lg bg-gray-50 animate-pulse",children:[(0,r.jsx)("div",{className:"w-8 h-8 rounded-full bg-gray-200"}),(0,r.jsxs)("div",{className:"space-y-2 flex-1",children:[(0,r.jsx)("div",{className:"h-2 w-1/4 bg-gray-200 rounded"}),(0,r.jsx)("div",{className:"h-2 w-1/2 bg-gray-200 rounded"})]})]}),(0,r.jsx)("div",{ref:A})]})}),(0,r.jsx)("div",{className:"border-t border-gray-200 bg-white p-4",children:(0,r.jsxs)("form",{onSubmit:O,className:"mx-auto max-w-3xl",children:[(0,r.jsxs)("div",{className:"relative rounded-lg border border-gray-300 bg-white shadow-sm focus-within:border-indigo-500 focus-within:ring-1 focus-within:ring-indigo-500",children:[(0,r.jsx)("input",{ref:D,type:"text",placeholder:"Ask anything about insurance, carriers, or agent management...",className:"block w-full rounded-lg border-0 py-3 pl-4 pr-12 text-gray-900 shadow-none outline-none focus:ring-0 sm:text-sm sm:leading-6",value:s,onChange:e=>o(e.target.value),onKeyDown:e=>{"Enter"!==e.key||e.shiftKey?"Escape"===e.key&&(e.preventDefault(),o("")):(e.preventDefault(),O())},disabled:d}),(0,r.jsx)("div",{className:"absolute inset-y-0 right-0 flex py-1.5 pr-1.5",children:(0,r.jsx)("button",{type:"submit",disabled:d||!s.trim(),className:`inline-flex items-center rounded-md px-2 py-1 text-sm ${d||!s.trim()?"text-gray-400":"text-indigo-600 hover:bg-indigo-50"}`,children:d?(0,r.jsxs)("svg",{className:"animate-spin h-5 w-5",xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",children:[(0,r.jsx)("circle",{className:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor",strokeWidth:"4"}),(0,r.jsx)("path",{className:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"})]}):(0,r.jsxs)("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",className:"h-5 w-5",children:[(0,r.jsx)("path",{d:"m22 2-7 20-4-9-9-4Z"}),(0,r.jsx)("path",{d:"M22 2 11 13"})]})})})]}),(0,r.jsxs)("div",{className:"mt-2 text-xs text-gray-500 flex justify-between items-center",children:[(0,r.jsxs)("div",{children:[(0,r.jsx)("kbd",{className:"px-1 py-0.5 bg-gray-100 border border-gray-300 rounded",children:"Shift"}),"+",(0,r.jsx)("kbd",{className:"px-1 py-0.5 bg-gray-100 border border-gray-300 rounded",children:"Enter"})," ","for new line"]}),(0,r.jsxs)("div",{children:[(0,r.jsx)("kbd",{className:"px-1 py-0.5 bg-gray-100 border border-gray-300 rounded",children:"/"})," ","to focus"]})]})]})})]})]})}},12151:function(){}},function(e){e.O(0,[1171,4392,6648,6837,2971,7023,1744],function(){return e(e.s=8346)}),_N_E=e.O()}]);