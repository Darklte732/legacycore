(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[7817],{1276:function(e,r,t){Promise.resolve().then(t.bind(t,73501))},73501:function(e,r,t){"use strict";t.r(r),t.d(r,{default:function(){return R}});var a=t(57437),s=t(2265),n=t(89733),i=t(48185),o=t(6683),l=t(82157),c=t(86864),d=t(2128),m=t(47304),u=t(35231),f=t(25974),h=t(54142),g=t(2842),x=t(9542),p=t(85475),b=t(45745),j=t(23909),y=t(85369),N=t(68295),w=t(20153),v=t(26032),_=t(54817),C=t(59738),k=t(90907),S=t(37164),D=t(56900),P=t(77209),I=t(79055);let E={PENDING:"Pending",PAID:"Paid",PROCESSING:"Processing",CHARGEBACK:"Chargeback"};function R(){let{role:e,loading:r}=(0,o.q)(),[t,I]=(0,s.useState)([]),[R,z]=(0,s.useState)([]),[M,U]=(0,s.useState)(!0),[Z,T]=(0,s.useState)(null),[$,Y]=(0,s.useState)("month"),[O,F]=(0,s.useState)("all"),[G,L]=(0,s.useState)("all"),[V,J]=(0,s.useState)(""),[W,B]=(0,s.useState)({field:"payment_date",direction:"desc"}),q=(0,l.e)(),[Q,K]=(0,s.useState)({totalEarnings:0,paidCommissions:0,pendingCommissions:0,chargebacks:0,carrierBreakdown:[],monthlyTrend:[]}),H=e=>new Intl.NumberFormat("en-US",{style:"currency",currency:"USD",minimumFractionDigits:0,maximumFractionDigits:0}).format(e),X=e=>e?new Date(e).toLocaleDateString("en-US",{year:"numeric",month:"short",day:"numeric"}):"N/A",ee=async()=>{try{U(!0);let{data:{session:e}}=await q.auth.getSession();if(!e){T("Please log in to view your commission data"),U(!1);return}console.log("Fetching commission data for user:",e.user.id);let{data:r,error:t}=await q.from("agent_applications").select("*").eq("agent_id",e.user.id).order("created_at",{ascending:!1});if(t){console.error("Error fetching applications data:",t),T("Failed to load applications data. Please try again later."),U(!1);return}console.log(`Found ${r?.length||0} applications`);let{data:a,error:s}=await q.from("commissions").select("*, policy_id").eq("agent_id",e.user.id).order("payment_date",{ascending:!1});s&&console.error("Error fetching commission data:",s),console.log(`Found ${a?.length||0} commission records`);let n=[];if(r&&r.length>0){console.log("Processing applications to generate commission data");let e=new Map;a&&a.length>0&&a.forEach(r=>{r.policy_id&&e.set(r.policy_id,r)}),r.forEach(r=>{if(!("Approved"===r.status||"1st Month Paid"===r.status||"Live"===r.status||"Paid"===r.status)&&!r.is_chargeback)return;let t=e.get(r.id);if(t){n.push({id:t.id,carrier:r.carrier||t.carrier||"Unknown Carrier",client_name:r.proposed_insured||t.client_name||"Unknown Client",policy_number:r.policy_number||t.policy_number||"",product:r.product||t.product||"Unknown Product",premium:Number(r.monthly_premium)||Number(t.premium)||0,commission_amount:Math.abs(Number(t.amount))||0,commission_percentage:Number(r.commission_percentage)||20,commission_split_percentage:Number(r.commission_split_percentage)||20,payment_date:t.payment_date||r.effective_policy_date||r.created_at,status:t.status||(r.is_chargeback?E.CHARGEBACK:"Paid"===r.paid_status?E.PAID:E.PENDING),payout_date:t.payout_date||r.effective_policy_date||null,is_chargeback:"CLAWBACK"===t.status||r.is_chargeback||!1,notes:t.notes||r.notes||null});return}let a=Number(r.monthly_premium)||0;if(a<=0)return;let s=Number(r.commission_split_percentage)||20,i=0;if(r.commission_amount&&Number(r.commission_amount)>0)i=Number(r.commission_amount);else{let e=9*a;i=1.05*e*(1-s/100)}let o=r.is_chargeback||!1,l=E.PENDING;o?l=E.CHARGEBACK:("Paid"===r.paid_status||"Approved"===r.status||"1st Month Paid"===r.status)&&(l=E.PAID),n.push({id:`app-${r.id}`,carrier:r.carrier||"Unknown Carrier",client_name:r.proposed_insured||"Unknown Client",policy_number:r.policy_number||`POL-${r.id.substring(0,6)}`,product:r.product||"Unknown Product",premium:a,commission_amount:i,commission_percentage:100,commission_split_percentage:s,payment_date:r.effective_policy_date||r.created_at,status:l,payout_date:l===E.PAID?r.effective_policy_date||r.created_at:null,is_chargeback:o,notes:r.notes||(o?"Chargeback":null)})})}n.length,n.sort((e,r)=>new Date(r.payment_date).getTime()-new Date(e.payment_date).getTime()),I(n),z(n);let i=er(n);K(i),U(!1)}catch(e){console.error("Error in fetchCommissionData:",e),T("Failed to load commission data. Please try again later."),U(!1)}},er=e=>{let r=e.reduce((e,r)=>r.is_chargeback?e:e+r.commission_amount,0),t=e.reduce((e,r)=>r.status===E.PAID?e+r.commission_amount:e,0),a=e.reduce((e,r)=>r.status===E.PENDING?e+r.commission_amount:e,0),s=e.reduce((e,r)=>r.is_chargeback?e+r.commission_amount:e,0),n=[],i=new Date,o=["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"];for(let r=11;r>=0;r--){let t=new Date(i.getFullYear(),i.getMonth()-r,1),a=o[t.getMonth()],s=t.getFullYear(),l=`${a} ${s}`,c=e.reduce((e,r)=>{if(r.is_chargeback)return e;let a=new Date(r.payment_date);return a.getMonth()===t.getMonth()&&a.getFullYear()===t.getFullYear()?e+r.commission_amount:e},0);n.push({month:l,amount:Math.round(c)})}let l=new Map;e.forEach(e=>{if(!e.is_chargeback){let r=(e.carrier||"Unknown").toUpperCase(),t=l.get(r)||0;l.set(r,t+e.commission_amount)}});let c=Array.from(l.entries()).map(e=>{let[r,t]=e;return{name:r.split(" ").map(e=>e.charAt(0).toUpperCase()+e.slice(1).toLowerCase()).join(" "),value:Math.round(t)}});return c.sort((e,r)=>r.value-e.value),{totalEarnings:Math.round(r),paidCommissions:Math.round(t),pendingCommissions:Math.round(a),chargebacks:Math.round(s),carrierBreakdown:c,monthlyTrend:n}},et=()=>{let e=[...t];if("all"!==$){let r;let t=new Date;switch($){case"week":(r=new Date(t)).setDate(t.getDate()-7);break;case"month":(r=new Date(t)).setMonth(t.getMonth()-1);break;case"quarter":(r=new Date(t)).setMonth(t.getMonth()-3);break;case"year":(r=new Date(t)).setFullYear(t.getFullYear()-1);break;default:r=new Date(0)}e=e.filter(e=>{if(!e.payment_date)return!1;let a=new Date(e.payment_date);return a>=r&&a<=t})}if("all"!==O&&(e=e.filter(e=>e.carrier.split(" ").map(e=>e.charAt(0).toUpperCase()+e.slice(1).toLowerCase()).join(" ")===O)),"all"!==G&&(e=e.filter(e=>e.status===G)),""!==V.trim()){let r=V.toLowerCase();e=e.filter(e=>e.client_name.toLowerCase().includes(r)||e.policy_number.toLowerCase().includes(r)||e.carrier.toLowerCase().includes(r)||e.product.toLowerCase().includes(r))}e.sort((e,r)=>{let t=e[W.field],a=r[W.field];if(null===t&&(t=""),null===a&&(a=""),W.field.includes("date")&&(t=t?new Date(t).getTime():0,a=a?new Date(a).getTime():0),"number"==typeof t&&"number"==typeof a)return"asc"===W.direction?t-a:a-t;let s=String(t).localeCompare(String(a));return"asc"===W.direction?s:-s}),z(e)},ea=e=>{B(r=>({field:e,direction:r.field===e&&"asc"===r.direction?"desc":"asc"}))};(0,s.useEffect)(()=>{r||ee()},[r]),(0,s.useEffect)(()=>{et()},[$,O,G,V,W,t]);let es=Array.from(new Set(t.map(e=>(e.carrier||"Unknown").split(" ").map(e=>e.charAt(0).toUpperCase()+e.slice(1).toLowerCase()).join(" ")))).sort();return M||r?(0,a.jsx)("div",{className:"flex h-screen items-center justify-center",children:(0,a.jsxs)("div",{className:"flex flex-col items-center",children:[(0,a.jsx)("div",{className:"animate-spin rounded-full h-10 w-10 border-b-2 border-blue-600 mb-3"}),(0,a.jsx)("p",{className:"text-gray-600",children:"Loading commission data..."})]})}):Z?(0,a.jsx)("div",{className:"flex h-screen flex-col items-center justify-center",children:(0,a.jsxs)("div",{className:"text-center max-w-md p-6 bg-white rounded-lg shadow-md",children:[(0,a.jsx)(v.Z,{className:"w-12 h-12 text-red-500 mx-auto mb-4"}),(0,a.jsx)("p",{className:"text-red-500 text-lg font-medium mb-4",children:Z}),(0,a.jsx)(n.z,{onClick:()=>window.location.reload(),children:"Retry"})]})}):(0,a.jsxs)("div",{className:"space-y-8",children:[(0,a.jsxs)("div",{className:"grid gap-4 md:grid-cols-4",children:[(0,a.jsx)(i.Zb,{className:"bg-gradient-to-br from-purple-50 to-blue-50 border-blue-200",children:(0,a.jsx)(i.aY,{className:"p-6",children:(0,a.jsxs)("div",{className:"flex flex-col space-y-2",children:[(0,a.jsx)("div",{className:"text-blue-500 text-sm font-medium",children:"Total Earnings"}),(0,a.jsxs)("div",{className:"text-3xl font-bold",children:["$",Math.round(Q.totalEarnings).toLocaleString()]}),(0,a.jsx)("div",{className:"text-gray-500 text-xs",children:"After upline split"})]})})}),(0,a.jsx)(i.Zb,{className:"bg-gradient-to-br from-green-50 to-emerald-50 border-green-200",children:(0,a.jsx)(i.aY,{className:"p-6",children:(0,a.jsxs)("div",{className:"flex flex-col space-y-2",children:[(0,a.jsx)("div",{className:"text-green-600 text-sm font-medium",children:"Paid Commissions"}),(0,a.jsxs)("div",{className:"text-3xl font-bold",children:["$",Math.round(Q.paidCommissions).toLocaleString()]}),(0,a.jsx)("div",{className:"text-gray-500 text-xs",children:"Total paid amount"})]})})}),(0,a.jsx)(i.Zb,{className:"bg-gradient-to-br from-amber-50 to-yellow-50 border-amber-200",children:(0,a.jsx)(i.aY,{className:"p-6",children:(0,a.jsxs)("div",{className:"flex flex-col space-y-2",children:[(0,a.jsx)("div",{className:"text-amber-600 text-sm font-medium",children:"Pending"}),(0,a.jsxs)("div",{className:"text-3xl font-bold",children:["$",Math.round(Q.pendingCommissions).toLocaleString()]}),(0,a.jsx)("div",{className:"text-gray-500 text-xs",children:"Awaiting payment"})]})})}),(0,a.jsx)(i.Zb,{className:"bg-gradient-to-br from-red-50 to-rose-50 border-red-200",children:(0,a.jsx)(i.aY,{className:"p-6",children:(0,a.jsxs)("div",{className:"flex flex-col space-y-2",children:[(0,a.jsx)("div",{className:"text-red-600 text-sm font-medium",children:"Chargebacks"}),(0,a.jsxs)("div",{className:"text-3xl font-bold",children:["$",Math.round(Q.chargebacks).toLocaleString()]}),(0,a.jsx)("div",{className:"text-gray-500 text-xs",children:"Total chargeback amount"})]})})})]}),(0,a.jsxs)("div",{className:"grid gap-6 md:grid-cols-2",children:[(0,a.jsxs)(i.Zb,{children:[(0,a.jsxs)(i.Ol,{children:[(0,a.jsx)(i.ll,{children:"Monthly Earnings Trend"}),(0,a.jsx)(i.SZ,{children:"Your commission earnings over the last 12 months"})]}),(0,a.jsx)(i.aY,{children:(0,a.jsx)("div",{className:"h-[300px]",children:(0,a.jsx)(u.h,{width:"100%",height:"100%",children:(0,a.jsxs)(f.v,{data:Q.monthlyTrend,margin:{top:10,right:10,left:10,bottom:20},children:[(0,a.jsx)(h.q,{strokeDasharray:"3 3",vertical:!1}),(0,a.jsx)(g.K,{dataKey:"month",tick:{fontSize:12},tickMargin:10}),(0,a.jsx)(x.B,{tick:{fontSize:12},tickFormatter:e=>`$${e}`}),(0,a.jsx)(p.u,{formatter:e=>[`$${Number(e).toLocaleString()}`,"Commission Amount"],labelFormatter:e=>`Month: ${e}`}),(0,a.jsx)(b.$,{dataKey:"amount",fill:"#4f46e5",name:"Commission Amount",radius:[4,4,0,0]})]})})})})]}),(0,a.jsxs)(i.Zb,{children:[(0,a.jsxs)(i.Ol,{children:[(0,a.jsx)(i.ll,{children:"Carrier Breakdown"}),(0,a.jsx)(i.SZ,{children:"Commission distribution by carrier"})]}),(0,a.jsx)(i.aY,{children:(0,a.jsx)("div",{className:"h-[300px]",children:(0,a.jsx)(u.h,{width:"100%",height:"100%",children:(0,a.jsxs)(j.u,{children:[(0,a.jsx)(y.b,{data:Q.carrierBreakdown,dataKey:"value",nameKey:"name",cx:"50%",cy:"50%",outerRadius:80,label:e=>{let{name:r,percent:t}=e;return`${r}: ${(100*t).toFixed(0)}%`},labelLine:!1,children:Q.carrierBreakdown.map((e,r)=>{let t=["#4f46e5","#10b981","#fbbf24","#ef4444","#06b6d4","#8b5cf6"];return(0,a.jsx)(N.b,{fill:t[r%t.length]},`cell-${r}`)})}),(0,a.jsx)(w.D,{verticalAlign:"bottom",formatter:(e,r,t)=>{let a=Q.carrierBreakdown[t];return`${e}: ${H(a.value)}`}}),(0,a.jsx)(p.u,{formatter:e=>[H(Number(e)),"Commission Amount"],itemStyle:{color:"#374151"}})]})})})})]})]}),(0,a.jsxs)(i.Zb,{className:"border-0 shadow-lg",children:[(0,a.jsx)(i.Ol,{className:"bg-gradient-to-r from-gray-50 to-gray-100 border-b",children:(0,a.jsxs)("div",{className:"flex flex-col sm:flex-row sm:justify-between sm:items-center",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)(i.ll,{children:"Commission Records"}),(0,a.jsxs)(i.SZ,{className:"mt-1",children:[R.length," ",1===R.length?"record":"records"," found"]})]}),(0,a.jsxs)("div",{className:"flex items-center mt-4 sm:mt-0",children:[(0,a.jsxs)("div",{className:"relative",children:[(0,a.jsx)(_.Z,{className:"absolute left-2.5 top-2.5 h-4 w-4 text-gray-400"}),(0,a.jsx)(P.I,{type:"text",placeholder:"Search records...",className:"pl-9 w-64",value:V,onChange:e=>J(e.target.value)})]}),(0,a.jsx)(n.z,{variant:"outline",size:"icon",className:"ml-2",onClick:()=>J(""),children:(0,a.jsx)(C.Z,{className:"h-4 w-4"})}),(0,a.jsxs)(n.z,{variant:"outline",className:"ml-2",onClick:()=>ee(),children:[(0,a.jsx)(k.Z,{className:"mr-2 h-4 w-4"}),"Refresh"]})]})]})}),(0,a.jsxs)("div",{className:"px-6 pt-6 pb-2 border-b",children:[(0,a.jsx)("div",{className:"flex flex-col md:flex-row gap-4",children:(0,a.jsx)(c.mQ,{defaultValue:"all",className:"w-full",onValueChange:e=>{switch(e){case"all":case"week":case"month":case"quarter":case"year":Y(e)}},children:(0,a.jsxs)(c.dr,{className:"grid grid-cols-5 mb-4",children:[(0,a.jsx)(c.SP,{value:"all",children:"All Time"}),(0,a.jsx)(c.SP,{value:"week",children:"This Week"}),(0,a.jsx)(c.SP,{value:"month",children:"This Month"}),(0,a.jsx)(c.SP,{value:"quarter",children:"This Quarter"}),(0,a.jsx)(c.SP,{value:"year",children:"This Year"})]})})}),(0,a.jsxs)("div",{className:"flex flex-col sm:flex-row gap-4 mb-4",children:[(0,a.jsx)("div",{className:"w-full sm:w-48",children:(0,a.jsxs)(d.Ph,{value:O,onValueChange:F,children:[(0,a.jsx)(d.i4,{children:(0,a.jsx)(d.ki,{placeholder:"All Carriers"})}),(0,a.jsxs)(d.Bw,{children:[(0,a.jsx)(d.Ql,{value:"all",children:"All Carriers"}),es.map(e=>(0,a.jsx)(d.Ql,{value:e,children:e},e))]})]})}),(0,a.jsx)("div",{className:"w-full sm:w-48",children:(0,a.jsxs)(d.Ph,{value:G,onValueChange:L,children:[(0,a.jsx)(d.i4,{children:(0,a.jsx)(d.ki,{placeholder:"All Statuses"})}),(0,a.jsxs)(d.Bw,{children:[(0,a.jsx)(d.Ql,{value:"all",children:"All Statuses"}),(0,a.jsx)(d.Ql,{value:E.PAID,children:"Paid"}),(0,a.jsx)(d.Ql,{value:E.PENDING,children:"Pending"}),(0,a.jsx)(d.Ql,{value:E.PROCESSING,children:"Processing"}),(0,a.jsx)(d.Ql,{value:E.CHARGEBACK,children:"Chargebacks"})]})]})}),(0,a.jsx)("div",{className:"flex-1 flex justify-end",children:(0,a.jsxs)(n.z,{variant:"outline",children:[(0,a.jsx)(S.Z,{className:"mr-2 h-4 w-4"}),"Export"]})})]})]}),(0,a.jsx)(i.aY,{className:"p-0",children:(0,a.jsx)("div",{className:"overflow-x-auto",children:(0,a.jsxs)(m.iA,{children:[(0,a.jsx)(m.xD,{children:(0,a.jsxs)(m.SC,{children:[(0,a.jsx)(m.ss,{className:"w-[180px]",children:(0,a.jsxs)(n.z,{variant:"ghost",size:"sm",className:"text-xs font-semibold",onClick:()=>ea("payment_date"),children:["Date",(0,a.jsx)(D.Z,{className:"ml-2 h-3 w-3"})]})}),(0,a.jsx)(m.ss,{children:(0,a.jsxs)(n.z,{variant:"ghost",size:"sm",className:"text-xs font-semibold",onClick:()=>ea("client_name"),children:["Client",(0,a.jsx)(D.Z,{className:"ml-2 h-3 w-3"})]})}),(0,a.jsx)(m.ss,{children:(0,a.jsxs)(n.z,{variant:"ghost",size:"sm",className:"text-xs font-semibold",onClick:()=>ea("carrier"),children:["Carrier",(0,a.jsx)(D.Z,{className:"ml-2 h-3 w-3"})]})}),(0,a.jsx)(m.ss,{children:(0,a.jsxs)(n.z,{variant:"ghost",size:"sm",className:"text-xs font-semibold",onClick:()=>ea("product"),children:["Product",(0,a.jsx)(D.Z,{className:"ml-2 h-3 w-3"})]})}),(0,a.jsx)(m.ss,{className:"text-right",children:(0,a.jsxs)(n.z,{variant:"ghost",size:"sm",className:"text-xs font-semibold",onClick:()=>ea("premium"),children:["Premium",(0,a.jsx)(D.Z,{className:"ml-2 h-3 w-3"})]})}),(0,a.jsx)(m.ss,{className:"text-right",children:(0,a.jsxs)(n.z,{variant:"ghost",size:"sm",className:"text-xs font-semibold",onClick:()=>ea("commission_amount"),children:["Commission",(0,a.jsx)(D.Z,{className:"ml-2 h-3 w-3"})]})}),(0,a.jsx)(m.ss,{children:(0,a.jsxs)(n.z,{variant:"ghost",size:"sm",className:"text-xs font-semibold",onClick:()=>ea("status"),children:["Status",(0,a.jsx)(D.Z,{className:"ml-2 h-3 w-3"})]})}),(0,a.jsx)(m.ss,{children:(0,a.jsxs)(n.z,{variant:"ghost",size:"sm",className:"text-xs font-semibold",onClick:()=>ea("payout_date"),children:["Payout Date",(0,a.jsx)(D.Z,{className:"ml-2 h-3 w-3"})]})})]})}),(0,a.jsx)(m.RM,{children:R.length>0?R.map(e=>(0,a.jsxs)(m.SC,{className:e.is_chargeback?"bg-red-50":"",children:[(0,a.jsx)(m.pj,{className:"font-medium",children:X(e.payment_date)}),(0,a.jsxs)(m.pj,{children:[(0,a.jsx)("div",{className:"font-medium",children:e.client_name}),(0,a.jsxs)("div",{className:"text-xs text-gray-500",children:["#",e.policy_number]})]}),(0,a.jsx)(m.pj,{children:e.carrier}),(0,a.jsx)(m.pj,{children:e.product}),(0,a.jsxs)(m.pj,{className:"text-right",children:["$",e.premium,"/mo"]}),(0,a.jsxs)(m.pj,{className:"text-right font-medium",children:["$",Math.round(e.commission_amount)]}),(0,a.jsx)(m.pj,{children:(0,a.jsx)(A,{status:e.status})}),(0,a.jsx)(m.pj,{children:X(e.payout_date)})]},e.id)):(0,a.jsx)(m.SC,{children:(0,a.jsx)(m.pj,{colSpan:8,className:"h-24 text-center",children:"No commission records found matching your filters"})})})]})})}),(0,a.jsxs)(i.eW,{className:"flex justify-between items-center border-t py-4 bg-gray-50",children:[(0,a.jsxs)("div",{className:"text-sm text-gray-500",children:["Showing ",R.length," of ",t.length," records"]}),(0,a.jsxs)("div",{className:"flex items-center",children:[(0,a.jsx)(n.z,{variant:"outline",size:"sm",className:"text-xs mr-2",disabled:!0,children:"Previous"}),(0,a.jsx)(n.z,{variant:"outline",size:"sm",className:"text-xs",disabled:!0,children:"Next"})]})]})]}),(0,a.jsxs)(i.Zb,{className:"border-0 shadow-md",children:[(0,a.jsx)(i.Ol,{className:"bg-gradient-to-r from-slate-50 to-slate-100 border-b",children:(0,a.jsx)(i.ll,{className:"text-slate-700",children:"Commission Policies"})}),(0,a.jsxs)(i.aY,{className:"pt-6 prose prose-sm max-w-none",children:[(0,a.jsx)("p",{children:"Your commissions are calculated based on the following guidelines:"}),(0,a.jsxs)("ul",{children:[(0,a.jsxs)("li",{children:[(0,a.jsx)("span",{className:"font-medium",children:"Final Expense Policies:"})," Carriers typically pay a 75-100% first-year commission on the annual premium, with renewal commissions ranging from 5-10% in subsequent years."]}),(0,a.jsxs)("li",{children:[(0,a.jsx)("span",{className:"font-medium",children:"Term Life Insurance:"})," First-year commissions typically range from 50-90% of the first-year premium, with 2-5% renewals in subsequent years."]}),(0,a.jsxs)("li",{children:[(0,a.jsx)("span",{className:"font-medium",children:"Whole Life Insurance:"})," First-year commissions generally range from 55-95% of the first-year premium, with renewals of 3-10% depending on the carrier and product."]}),(0,a.jsxs)("li",{children:[(0,a.jsx)("span",{className:"font-medium",children:"Chargebacks:"})," If a client cancels their policy during the first 9-12 months, the carrier will typically request a full or pro-rated refund of the commission advanced."]}),(0,a.jsxs)("li",{children:[(0,a.jsx)("span",{className:"font-medium",children:"Advance Commission:"})," Most carriers offer 9-month to 12-month advance commission options, subject to your contract terms and performance requirements."]}),(0,a.jsxs)("li",{children:[(0,a.jsx)("span",{className:"font-medium",children:"Payment Timeline:"})," Commissions are typically processed within 7-14 days after policy issuance and receipt of the first premium payment."]})]}),(0,a.jsx)("p",{children:"For specific questions about your commission structure or payment schedules for specific carriers, please contact your manager or review your carrier contract terms."})]})]})]})}let A=e=>{let{status:r}=e;switch(r){case E.PAID:return(0,a.jsx)(I.C,{className:"bg-green-100 text-green-800 border border-green-200 hover:bg-green-100",children:"Paid"});case E.PENDING:return(0,a.jsx)(I.C,{className:"bg-yellow-100 text-yellow-800 border border-yellow-200 hover:bg-yellow-100",children:"Pending"});case E.PROCESSING:return(0,a.jsx)(I.C,{className:"bg-blue-100 text-blue-800 border border-blue-200 hover:bg-blue-100",children:"Processing"});case E.CHARGEBACK:return(0,a.jsx)(I.C,{className:"bg-red-100 text-red-800 border border-red-200 hover:bg-red-100",children:"Chargeback"});default:return(0,a.jsx)(I.C,{className:"bg-gray-100 text-gray-800 border border-gray-200 hover:bg-gray-100",children:r})}}},79055:function(e,r,t){"use strict";t.d(r,{C:function(){return o}});var a=t(57437);t(2265);var s=t(13027),n=t(49354);let i=(0,s.j)("inline-flex items-center rounded-full border px-2.5 py-0.5 text-xs font-semibold transition-colors focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2",{variants:{variant:{default:"border-transparent bg-primary text-primary-foreground hover:bg-primary/80",secondary:"border-transparent bg-secondary text-secondary-foreground hover:bg-secondary/80",destructive:"border-transparent bg-destructive text-destructive-foreground hover:bg-destructive/80",outline:"text-foreground",success:"border-transparent bg-green-500 text-white hover:bg-green-600",warning:"border-transparent bg-yellow-500 text-white hover:bg-yellow-600"}},defaultVariants:{variant:"default"}});function o(e){let{className:r,variant:t,...s}=e;return(0,a.jsx)("div",{className:(0,n.cn)(i({variant:t}),r),...s})}},89733:function(e,r,t){"use strict";t.d(r,{d:function(){return l},z:function(){return c}});var a=t(57437),s=t(2265),n=t(71538),i=t(13027),o=t(49354);let l=(0,i.j)("inline-flex items-center justify-center whitespace-nowrap rounded-md text-sm font-medium ring-offset-background transition-colors focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:pointer-events-none disabled:opacity-50",{variants:{variant:{default:"bg-primary text-primary-foreground hover:bg-primary/90",destructive:"bg-destructive text-destructive-foreground hover:bg-destructive/90",outline:"border border-input bg-background hover:bg-accent hover:text-accent-foreground",secondary:"bg-secondary text-secondary-foreground hover:bg-secondary/80",ghost:"hover:bg-accent hover:text-accent-foreground",link:"text-primary underline-offset-4 hover:underline"},size:{default:"h-10 px-4 py-2",sm:"h-9 rounded-md px-3",lg:"h-11 rounded-md px-8",icon:"h-10 w-10"}},defaultVariants:{variant:"default",size:"default"}}),c=s.forwardRef((e,r)=>{let{className:t,variant:s,size:i,asChild:c=!1,...d}=e,m=c?n.g7:"button";return(0,a.jsx)(m,{className:(0,o.cn)(l({variant:s,size:i,className:t})),ref:r,...d})});c.displayName="Button"},48185:function(e,r,t){"use strict";t.d(r,{Ol:function(){return o},SZ:function(){return c},Zb:function(){return i},aY:function(){return d},eW:function(){return m},ll:function(){return l}});var a=t(57437),s=t(2265),n=t(49354);let i=s.forwardRef((e,r)=>{let{className:t,...s}=e;return(0,a.jsx)("div",{ref:r,className:(0,n.cn)("rounded-lg border bg-card text-card-foreground shadow-sm",t),...s})});i.displayName="Card";let o=s.forwardRef((e,r)=>{let{className:t,...s}=e;return(0,a.jsx)("div",{ref:r,className:(0,n.cn)("flex flex-col space-y-1.5 p-6",t),...s})});o.displayName="CardHeader";let l=s.forwardRef((e,r)=>{let{className:t,...s}=e;return(0,a.jsx)("h3",{ref:r,className:(0,n.cn)("text-2xl font-semibold leading-none tracking-tight",t),...s})});l.displayName="CardTitle";let c=s.forwardRef((e,r)=>{let{className:t,...s}=e;return(0,a.jsx)("p",{ref:r,className:(0,n.cn)("text-sm text-muted-foreground",t),...s})});c.displayName="CardDescription";let d=s.forwardRef((e,r)=>{let{className:t,...s}=e;return(0,a.jsx)("div",{ref:r,className:(0,n.cn)("p-6 pt-0",t),...s})});d.displayName="CardContent";let m=s.forwardRef((e,r)=>{let{className:t,...s}=e;return(0,a.jsx)("div",{ref:r,className:(0,n.cn)("flex items-center p-6 pt-0",t),...s})});m.displayName="CardFooter"},77209:function(e,r,t){"use strict";t.d(r,{I:function(){return i}});var a=t(57437),s=t(2265),n=t(49354);let i=s.forwardRef((e,r)=>{let{className:t,type:s,...i}=e;return(0,a.jsx)("input",{type:s,className:(0,n.cn)("flex h-10 w-full rounded-md border border-input bg-background px-3 py-2 text-sm ring-offset-background file:border-0 file:bg-transparent file:text-sm file:font-medium placeholder:text-muted-foreground focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50",t),ref:r,...i})});i.displayName="Input"},2128:function(e,r,t){"use strict";t.d(r,{Bw:function(){return f},DI:function(){return d},Ph:function(){return c},Ql:function(){return g},i4:function(){return u},ki:function(){return m},n5:function(){return h}});var a=t(57437),s=t(2265),n=t(88909),i=t(42421),o=t(22468),l=t(49354);let c=n.fC,d=n.ZA,m=n.B4,u=s.forwardRef((e,r)=>{let{className:t,children:s,...o}=e;return(0,a.jsxs)(n.xz,{ref:r,className:(0,l.cn)("flex h-10 w-full items-center justify-between rounded-md border border-input bg-background px-3 py-2 text-sm ring-offset-background placeholder:text-muted-foreground focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50",t),...o,children:[s,(0,a.jsx)(n.JO,{asChild:!0,children:(0,a.jsx)(i.Z,{className:"h-4 w-4 opacity-50"})})]})});u.displayName=n.xz.displayName;let f=s.forwardRef((e,r)=>{let{className:t,children:s,position:i="popper",...o}=e;return(0,a.jsx)(n.h_,{children:(0,a.jsx)(n.VY,{ref:r,className:(0,l.cn)("relative z-50 min-w-[8rem] overflow-hidden rounded-md border bg-white text-popover-foreground shadow-md data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2","popper"===i&&"data-[side=bottom]:translate-y-1 data-[side=left]:-translate-x-1 data-[side=right]:translate-x-1 data-[side=top]:-translate-y-1",t),position:i,...o,children:(0,a.jsx)(n.l_,{className:(0,l.cn)("p-1 bg-white","popper"===i&&"h-[var(--radix-select-trigger-height)] w-full min-w-[var(--radix-select-trigger-width)]"),children:s})})})});f.displayName=n.VY.displayName;let h=s.forwardRef((e,r)=>{let{className:t,...s}=e;return(0,a.jsx)(n.__,{ref:r,className:(0,l.cn)("py-1.5 pl-8 pr-2 text-sm font-semibold",t),...s})});h.displayName=n.__.displayName;let g=s.forwardRef((e,r)=>{let{className:t,children:s,...i}=e;return(0,a.jsxs)(n.ck,{ref:r,className:(0,l.cn)("relative flex w-full cursor-default select-none items-center rounded-sm py-1.5 pl-8 pr-2 text-sm outline-none focus:bg-accent focus:text-accent-foreground data-[disabled]:pointer-events-none data-[disabled]:opacity-50",t),...i,children:[(0,a.jsx)("span",{className:"absolute left-2 flex h-3.5 w-3.5 items-center justify-center",children:(0,a.jsx)(n.wU,{children:(0,a.jsx)(o.Z,{className:"h-4 w-4"})})}),(0,a.jsx)(n.eT,{children:s})]})});g.displayName=n.ck.displayName,s.forwardRef((e,r)=>{let{className:t,...s}=e;return(0,a.jsx)(n.Z0,{ref:r,className:(0,l.cn)("-mx-1 my-1 h-px bg-muted",t),...s})}).displayName=n.Z0.displayName},47304:function(e,r,t){"use strict";t.d(r,{RM:function(){return l},SC:function(){return c},iA:function(){return i},pj:function(){return m},ss:function(){return d},xD:function(){return o}});var a=t(57437),s=t(2265),n=t(49354);let i=s.forwardRef((e,r)=>{let{className:t,...s}=e;return(0,a.jsx)("div",{className:"relative w-full overflow-auto",children:(0,a.jsx)("table",{ref:r,className:(0,n.cn)("w-full caption-bottom text-sm",t),...s})})});i.displayName="Table";let o=s.forwardRef((e,r)=>{let{className:t,...s}=e;return(0,a.jsx)("thead",{ref:r,className:(0,n.cn)("[&_tr]:border-b",t),...s})});o.displayName="TableHeader";let l=s.forwardRef((e,r)=>{let{className:t,...s}=e;return(0,a.jsx)("tbody",{ref:r,className:(0,n.cn)("[&_tr:last-child]:border-0",t),...s})});l.displayName="TableBody",s.forwardRef((e,r)=>{let{className:t,...s}=e;return(0,a.jsx)("tfoot",{ref:r,className:(0,n.cn)("bg-primary font-medium text-primary-foreground",t),...s})}).displayName="TableFooter";let c=s.forwardRef((e,r)=>{let{className:t,...s}=e;return(0,a.jsx)("tr",{ref:r,className:(0,n.cn)("border-b transition-colors hover:bg-muted/50 data-[state=selected]:bg-muted",t),...s})});c.displayName="TableRow";let d=s.forwardRef((e,r)=>{let{className:t,...s}=e;return(0,a.jsx)("th",{ref:r,className:(0,n.cn)("h-12 px-4 text-left align-middle font-medium text-muted-foreground [&:has([role=checkbox])]:pr-0",t),...s})});d.displayName="TableHead";let m=s.forwardRef((e,r)=>{let{className:t,...s}=e;return(0,a.jsx)("td",{ref:r,className:(0,n.cn)("p-4 align-middle [&:has([role=checkbox])]:pr-0",t),...s})});m.displayName="TableCell",s.forwardRef((e,r)=>{let{className:t,...s}=e;return(0,a.jsx)("caption",{ref:r,className:(0,n.cn)("mt-4 text-sm text-muted-foreground",t),...s})}).displayName="TableCaption"},86864:function(e,r,t){"use strict";t.d(r,{SP:function(){return c},dr:function(){return l},mQ:function(){return o},nU:function(){return d}});var a=t(57437),s=t(2265),n=t(62447),i=t(49354);let o=n.fC,l=s.forwardRef((e,r)=>{let{className:t,...s}=e;return(0,a.jsx)(n.aV,{ref:r,className:(0,i.cn)("inline-flex h-10 items-center justify-center rounded-md bg-muted p-1 text-muted-foreground",t),...s})});l.displayName=n.aV.displayName;let c=s.forwardRef((e,r)=>{let{className:t,...s}=e;return(0,a.jsx)(n.xz,{ref:r,className:(0,i.cn)("inline-flex items-center justify-center whitespace-nowrap rounded-sm px-3 py-1.5 text-sm font-medium ring-offset-background transition-all focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:pointer-events-none disabled:opacity-50 data-[state=active]:bg-background data-[state=active]:text-foreground data-[state=active]:shadow-sm",t),...s})});c.displayName=n.xz.displayName;let d=s.forwardRef((e,r)=>{let{className:t,...s}=e;return(0,a.jsx)(n.VY,{ref:r,className:(0,i.cn)("mt-2 ring-offset-background focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2",t),...s})});d.displayName=n.VY.displayName},6683:function(e,r,t){"use strict";t.d(r,{q:function(){return n}});var a=t(2265),s=t(82157);let n=()=>{let[e,r]=(0,a.useState)(null),[t,n]=(0,a.useState)(!0),[i,o]=(0,a.useState)(!1),[l,c]=(0,a.useState)(0),d=(0,s.e)(),m=()=>{console.log("Clearing all role-related cookies to prevent conflicts"),document.cookie="force_manager_view=; path=/; expires=Thu, 01 Jan 1970 00:00:00 GMT",document.cookie="test_role=; path=/; expires=Thu, 01 Jan 1970 00:00:00 GMT",document.cookie="admin_redirected=; path=/; expires=Thu, 01 Jan 1970 00:00:00 GMT",document.cookie="handling_redirect=; path=/; expires=Thu, 01 Jan 1970 00:00:00 GMT"},u=async(e,r)=>{console.log("⚠️ SECURITY: Forcing removal of admin role for unauthorized user"),m();try{await d.from("profiles").update({role:"agent"}).eq("id",e),console.log("Updated database role from admin to agent");let{error:r}=await d.auth.updateUser({data:{role:"agent"}});r&&console.error("Error updating user metadata:",r),setTimeout(()=>window.location.href="/agent/dashboard",100)}catch(e){console.error("Error clearing admin role:",e)}},f=async(e,r)=>{try{console.log(`Synchronizing user metadata role to match database: ${r}`);let{error:e}=await d.auth.updateUser({data:{role:r}});e&&console.error("Error updating user metadata:",e)}catch(e){console.error("Error synchronizing roles:",e)}},h=e=>{let r=Date.now();if(i||r-l<2e3){console.log("Preventing potential redirect loop");return}o(!0),c(r),document.cookie="handling_redirect=true; path=/; max-age=5",setTimeout(()=>{console.log(`Redirecting to /${e}/dashboard`),window.location.href=`/${e}/dashboard`,o(!1)},100)};return(0,a.useEffect)(()=>{let e=async()=>{try{let e=window.location.pathname,s=e.startsWith("/admin"),i=e.startsWith("/manager"),o=e.startsWith("/agent");if(s||i||o){let e=document.cookie.split("; ").find(e=>e.startsWith("test_role="))?.split("=")[1];o&&e&&"agent"!==e&&(console.log(`Path is /agent but test_role cookie is ${e}, clearing to prevent sidebar mismatch`),m()),i&&e&&"manager"!==e&&(console.log(`Path is /manager but test_role cookie is ${e}, clearing to prevent sidebar mismatch`),m()),s&&e&&"admin"!==e&&(console.log(`Path is /admin but test_role cookie is ${e}, clearing to prevent sidebar mismatch`),m())}if(document.cookie.includes("handling_redirect=true")){console.log("Skipping role check - redirect in progress"),n(!1);return}let l=document.cookie.split("; ").find(e=>e.startsWith("force_manager_view="))?.split("=")[1],c=document.cookie.split("; ").find(e=>e.startsWith("test_role="))?.split("=")[1],{data:{session:g}}=await d.auth.getSession();if(!g){r(null),n(!1);return}let x=["980ebab6-9e1a-4c53-876a-978c8c640f7e","adbdb861-5ce8-4b5c-af50-7deb93a687c1"];if(g.user.user_metadata?.role==="admin"&&!x.includes(g.user.id)){await u(g.user.id,g.user.email||""),r("agent"),n(!1);return}if("true"===l){console.log("⚠️ FORCED MANAGER VIEW: Using manager role from force_manager_view cookie"),await a(g.user.id,g.user.email,"manager"),r("manager"),n(!1);return}if(o){console.log("\uD83D\uDC49 On agent path, ensuring agent role and sidebar"),c&&m(),r("agent"),n(!1);return}if(i){console.log("\uD83D\uDC49 On manager path, ensuring manager role and sidebar"),c&&m(),r("manager"),n(!1);return}if(s){if(x.includes(g.user.id)){console.log("\uD83D\uDC49 On admin path with valid admin ID, ensuring admin role and sidebar"),c&&m(),r("admin"),n(!1);return}console.log("⚠️ SECURITY: Non-admin attempting to access admin path"),m(),h("agent");return}if("56e8e969-76fd-4d69-a8ca-3e315487c2c4"===g.user.id){console.log("⚠️ APPLYING ROLE OVERRIDE: Setting role to manager for santosUser"),await a(g.user.id,g.user.email,"manager"),r("manager"),n(!1);return}if(c&&["admin","manager","agent"].includes(c)){if("admin"===c&&!x.includes(g.user.id)){console.log("⚠️ SECURITY: Unauthorized admin access attempt via cookie. Defaulting to agent role."),document.cookie="test_role=agent; path=/; max-age=86400",r("agent"),n(!1);return}console.log(`⚠️ DEVELOPMENT MODE: Using ${c} role from test_role cookie`),r(c),n(!1);return}let{data:p}=await d.from("profiles").select("role").eq("id",g.user.id).single();if(p&&p.role){if(console.log(`Using role from database profile: ${p.role}`),"admin"===p.role&&!x.includes(g.user.id)){console.warn("⚠️ SECURITY: Unauthorized admin role in database. Correcting to agent."),await u(g.user.id,g.user.email||""),r("agent"),n(!1);return}if(g.user.user_metadata?.role&&g.user.user_metadata.role!==p.role&&(console.warn(`⚠️ Role mismatch: metadata (${g.user.user_metadata.role}) vs database (${p.role}). Using database role.`),await f(g.user.id,p.role)),r(p.role),e.startsWith("/admin")&&"admin"!==p.role){console.log(`⚠️ Path mismatch: User with role ${p.role} on admin path. Redirecting...`),n(!1),h(p.role);return}if(e.startsWith("/manager")&&"manager"!==p.role){console.log(`⚠️ Path mismatch: User with role ${p.role} on manager path. Redirecting...`),n(!1),h(p.role);return}if(e.startsWith("/agent")&&"agent"!==p.role){console.log(`⚠️ Path mismatch: User with role ${p.role} on agent path. Redirecting...`),n(!1),h(p.role);return}n(!1);return}if(g.user.user_metadata?.role&&["admin","manager","agent"].includes(g.user.user_metadata.role)){if("admin"===g.user.user_metadata.role&&!x.includes(g.user.id)){console.warn("⚠️ SECURITY: Unauthorized admin role in metadata. Correcting to agent."),await u(g.user.id,g.user.email||""),r("agent"),n(!1);return}console.log(`Using role from user metadata (no profile): ${g.user.user_metadata.role}`),await t(g.user.id,g.user.email,g.user.user_metadata.role),r(g.user.user_metadata.role)}else console.log("No role found. Defaulting to agent role."),await t(g.user.id,g.user.email||"","agent"),r("agent");n(!1)}catch(e){console.error("Error determining user role:",e),r(null),n(!1)}},t=async(e,r,t)=>{try{let{error:a}=await d.from("profiles").insert({id:e,email:r,role:t}).select();a&&console.error("Error creating user profile:",a)}catch(e){console.error("Error in profile creation:",e)}},a=async(e,r,a)=>{try{let{data:s}=await d.from("profiles").select("role").eq("id",e).single();s?s.role!==a&&(await d.from("profiles").update({role:a}).eq("id",e),console.log(`Updated profile role from ${s.role} to ${a}`)):(await t(e,r,a),console.log(`Created new profile with role ${a}`))}catch(e){console.error("Error ensuring profile has role:",e)}};e();let{data:{subscription:s}}=d.auth.onAuthStateChange((t,a)=>{if(!a){r(null);return}e()});return()=>{s.unsubscribe()}},[d,i,l]),{role:e,loading:t,isAdmin:"admin"===e,isManager:"manager"===e,isAgent:"agent"===e}}},82157:function(e,r,t){"use strict";t.d(r,{e:function(){return s}});var a=t(64392);let s=()=>(0,a.createClientComponentClient)({supabaseUrl:"https://iufyuzmigirugcufrtvt.supabase.co",supabaseKey:"eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6Iml1Znl1em1pZ2lydWdjdWZydHZ0Iiwicm9sZSI6ImFub24iLCJpYXQiOjE3NDUwMzQxMjcsImV4cCI6MjA2MDYxMDEyN30.V38OGEX1Oy3gFfu5ClGWRk3xYAhb_DVr-5ojOQZ1UfU"});(0,a.createClientComponentClient)({supabaseUrl:"https://iufyuzmigirugcufrtvt.supabase.co",supabaseKey:"eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6Iml1Znl1em1pZ2lydWdjdWZydHZ0Iiwicm9sZSI6ImFub24iLCJpYXQiOjE3NDUwMzQxMjcsImV4cCI6MjA2MDYxMDEyN30.V38OGEX1Oy3gFfu5ClGWRk3xYAhb_DVr-5ojOQZ1UfU"})},49354:function(e,r,t){"use strict";t.d(r,{cn:function(){return n}});var a=t(44839),s=t(96164);function n(){for(var e=arguments.length,r=Array(e),t=0;t<e;t++)r[t]=arguments[t];return(0,s.m6)((0,a.W)(r))}}},function(e){e.O(0,[4392,4868,9776,921,1172,1049,7366,8853,2971,7023,1744],function(){return e(e.s=1276)}),_N_E=e.O()}]);